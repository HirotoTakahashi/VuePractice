<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
    <style>
      .resizable {
        cursor: ew-resize;
      }
    </style>
  </head>
  <body>
    <div id="app1" style="width: 100%; height: 50px;">
      <svg width="100%" height="100%">
        <rect width="100%" height="100%" />
        <rect :x="rectX" y="0" :width="rectWidth" height="50" fill="#ddd" />
        <g @mousedown="md($event, 1)" @touchstart="md($event, 1)">
          <line
            :x1="xLeft"
            :x2="xLeft"
            y1="0"
            y2="50"
            stroke="#ddd"
            stroke-width="10"
            class="resizable"
          />
          <!-- <circle :cx="xLeft" :cy="y" r="10" fill="#fff" /> -->
        </g>
        <g @mousedown="md($event, 2)" @touchstart="md($event, 2)">
          <line
            :x1="xRight"
            :x2="xRight"
            y1="0"
            y2="50"
            stroke="#ddd"
            stroke-width="10"
            class="resizable"
          />
          <!-- <circle :cx="xRight" :cy="y" r="10" fill="#fff" /> -->
        </g>
      </svg>
      <div>
        {{ isMove1 }}, {{ xLeft }}, {{ isMove2 }}, {{ xRight }}, {{ xClient }}
      </div>
    </div>
    <div id="app2" style="width: 100%; height: 50px;">
      <svg width="100%" height="100%">
        <rect width="100%" height="100%" />
        <rect :x="rectX" y="0" :width="rectWidth" height="50" fill="#ddd" />
        <g @mousedown="md($event, 1)" @touchstart="md($event, 1)">
          <line
            :x1="xLeft"
            :x2="xLeft"
            y1="0"
            y2="50"
            stroke="#ddd"
            stroke-width="10"
            class="resizable"
          />
          <!-- <circle :cx="xLeft" :cy="y" r="10" fill="#fff" /> -->
        </g>
        <g @mousedown="md($event, 2)" @touchstart="md($event, 2)">
          <line
            :x1="xRight"
            :x2="xRight"
            y1="0"
            y2="50"
            stroke="#ddd"
            stroke-width="10"
            class="resizable"
          />
          <!-- <circle :cx="xRight" :cy="y" r="10" fill="#fff" /> -->
        </g>
      </svg>
      <div>
        {{ isMove1 }}, {{ xLeft }}, {{ isMove2 }}, {{ xRight }}, {{ xClient }}
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script>
      var app1 = new Vue({
        el: "#app1",
        data: function() {
          return {
            xLeft: 20,
            xRight: 120,
            // y: 25,
            // width: 200,
            isMove1: false,
            isMove2: false,
            xClient: 0
          };
        },
        computed: {
          rectWidth: function() {
            return this.xLeft < this.xRight
              ? this.xRight - this.xLeft
              : this.xLeft - this.xRight;
          },
          rectX() {
            return this.xLeft < this.xRight ? this.xLeft : this.xRight;
          }
        },
        methods: {
          md(ev, val) {
            if (val === 1) {
              this.isMove1 = true;
            } else if (val === 2) {
              this.isMove2 = true;
            }
            document.addEventListener("mousemove", this.mm);
            document.addEventListener("mouseup", this.mu);
            document.addEventListener("touchmove", this.tm);
            document.addEventListener("touchend", this.mu);
          },
          mu() {
            this.isMove1 = false;
            this.isMove2 = false;
            document.removeEventListener("mousemove", this.mm);
            document.removeEventListener("mouseup", this.mu);
            document.removeEventListener("touchmove", this.tm);
            document.removeEventListener("touchend", this.mu);
          },
          mm(ev) {
            this.xClient = ev.clientX;
            if (this.isMove1) {
              // todo: fix magic number
              this.xLeft = ev.clientX - 10;
            } else if (this.isMove2) {
              this.xRight = ev.clientX - 10;
            }
          },
          tm(ev) {
            if (this.isMove1) {
              // todo: fix magic number
              this.xLeft = ev.touches[0].clientX - 10;
            } else if (this.isMove2) {
              this.xRight = ev.touches[0].clientX - 10;
            }
          }
        }
      });
      var app2 = new Vue({
        el: "#app2",
        data: function() {
          return {
            xLeft: 20,
            xRight: 120,
            // y: 25,
            // width: 200,
            isMove1: false,
            isMove2: false,
            xClient: 0
          };
        },
        computed: {
          rectWidth: function() {
            return this.xLeft < this.xRight
              ? this.xRight - this.xLeft
              : this.xLeft - this.xRight;
          },
          rectX() {
            return this.xLeft < this.xRight ? this.xLeft : this.xRight;
          }
        },
        methods: {
          md(ev, val) {
            if (val === 1) {
              this.isMove1 = true;
            } else if (val === 2) {
              this.isMove2 = true;
            }
            document.addEventListener("mousemove", this.mm);
            document.addEventListener("mouseup", this.mu);
            document.addEventListener("touchmove", this.tm);
            document.addEventListener("touchend", this.mu);
          },
          mu() {
            this.isMove1 = false;
            this.isMove2 = false;
            document.removeEventListener("mousemove", this.mm);
            document.removeEventListener("mouseup", this.mu);
            document.removeEventListener("touchmove", this.tm);
            document.removeEventListener("touchend", this.mu);
          },
          mm(ev) {
            this.xClient = ev.clientX;
            if (this.isMove1) {
              // todo: fix magic number
              if (ev.clientX > this.xLeft) {
                // this.xLeft = ev.clientX - 10;
                this.xLeft = ev.clientX + 30;
              }
            } else if (this.isMove2) {
              if (ev.clientX > this.xRight) {
                // this.xRight = ev.clientX - 10;
                this.xRight = ev.clientX + 30;
              }
            }
          },
          tm(ev) {
            if (this.isMove1) {
              // todo: fix magic number
              this.xLeft = ev.touches[0].clientX - 10;
            } else if (this.isMove2) {
              this.xRight = ev.touches[0].clientX - 10;
            }
          }
        }
      });
    </script>
  </body>
</html>
